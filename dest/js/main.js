"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var level=document.querySelector(".level"),life=document.querySelector(".life"),img=document.querySelector(".image"),lifeCount=3,heartFlag=!1,heartSpawnFlag=!1,heartPosition=[[100,60],[300,145],[500,60]],levelCount=1,Enemy=function(e,t,n){this.x=e,this.y=t,this.speed=n,this.sprite="images/enemy-bug.png",this.stone="images/Rock.png"},getDistance=function(e,t,n,a){var r=t-e,i=a-n;return Math.sqrt(Math.pow(r,2)+Math.pow(i,2))};Enemy.prototype.update=function(e){if(this.x+=this.speed*levelCount*e,700<this.x&&(this.x=-75),player.x===heart.x&&player.y===heart.y&&heartSpawnFlag){delete heart.heart,heartFlag=!0,Player.lifeCount++;var t=new Image;t.src="images/Heart.png",t.alt="character img",t.classList.add("images","img"),img.appendChild(t),heartSpawnFlag=!1}(getDistance(this.x,player.x,this.y,player.y)<75&&this.y===player.y&&1<=Player.lifeCount||100===player.x&&230===player.y&&1<levelCount||400===player.x&&230===player.y&&2<levelCount||600===player.x&&145===player.y&&3<levelCount)&&(player.respawn(),(heart=new Heart(heartPosition[Math.floor(Math.random()*heartPosition.length)][0],heartPosition[Math.floor(Math.random()*heartPosition.length)][1])).heart="images/Heart.png",heartFlag=!(heartSpawnFlag=!0),life.innerHTML="Total life available",Player.lifeCount<1&&(swal({title:"Game over!",text:"No more lifes remaining",icon:"error",button:"Start again!"}),player.hardRestart()))},Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y),2===levelCount?ctx.drawImage(Resources.get(this.stone),100,230):3===levelCount?(ctx.drawImage(Resources.get(this.stone),100,230),ctx.drawImage(Resources.get(this.stone),400,230)):4===levelCount&&(ctx.drawImage(Resources.get(this.stone),100,230),ctx.drawImage(Resources.get(this.stone),400,230),ctx.drawImage(Resources.get(this.stone),600,145))};var randomSpeedGen=function(e,t){return Math.random()*(t-e)+e},enemy1=new Enemy(-75,60,randomSpeedGen(100,200)),enemy2=new Enemy(-75,145,randomSpeedGen(100,200)),enemy3=new Enemy(-75,230,randomSpeedGen(100,200)),Heart=function(){function n(e,t){_classCallCheck(this,n),this.x=e,this.y=t,this.heart="images/Heart.png"}return _createClass(n,[{key:"render",value:function(){ctx.drawImage(Resources.get(this.heart),this.x,this.y)}}]),n}(),Player=function(){function n(e,t){_classCallCheck(this,n),this.x=e,this.y=t,this.sprite="images/char-boy.png"}return _createClass(n,[{key:"handleInput",value:function(e){"left"===e&&4<=this.x&&(this.x-=100),"right"===e&&this.x<600&&(this.x+=100),"up"===e&&-20<this.y&&(this.y-=85),"down"===e&&this.y<400&&(this.y+=85)}},{key:"update",value:function(){if(-25===this.y&&(console.log("this is win"),swal({title:"Good job!",text:"You won this level",icon:"success",button:"Play next!"}),this.x=200,this.y=400,levelCount++,level.innerHTML="Level - ".concat(levelCount)),4<levelCount){swal({title:"Congratulations",text:"You won the game",icon:"success",button:"Enjoy!"}),levelCount=1;for(var e=0;e<n.lifeCount;e++)img.removeChild(img.firstElementChild);player.hardRestart()}}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)}},{key:"respawn",value:function(){swal({title:"Try again!",text:"bugs are deadly",icon:"error",button:"Play again!"}),this.x=200,this.y=400,n.lifeCount<1&&(levelCount=1),--n.lifeCount<3&&img.removeChild(img.firstElementChild)}},{key:"hardRestart",value:function(){this.x=200,this.y=400,n.lifeCount=3,levelCount=1,level.innerHTML="Level - ".concat(levelCount),delete heart.heart,heartSpawnFlag=heartFlag=!1;for(var e=0;e<3;e++){var t=new Image;t.src="images/Heart.png",t.alt="character img",t.classList.add("images","img"),img.appendChild(t)}}}]),n}(),heart=new Heart(heartPosition[Math.floor(Math.random()*heartPosition.length)][0],heartPosition[Math.floor(Math.random()*heartPosition.length)][1]),player=new Player(200,400),allEnemies=[];allEnemies.push(enemy1,enemy2,enemy3),document.addEventListener("keyup",function(e){console.log("hi");player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])});var Engine=function(e){var t,n=e.document,a=e.window,r=n.createElement("canvas"),i=r.getContext("2d");function o(){var e=Date.now();!function(e){!function(t){allEnemies.forEach(function(e){e.update(t)}),player.update()}(e)}((e-t)/1e3),function(){var e,t,n=["images/water-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/grass-block.png","images/grass-block.png"];for(i.clearRect(0,0,r.width,r.height),e=0;e<6;e++)for(t=0;t<7;t++)i.drawImage(Resources.get(n[e]),101*t,83*e);allEnemies.forEach(function(e){e.render()}),player.render(),!heartFlag&&heartSpawnFlag&&heart.render()}(),t=e,a.requestAnimationFrame(o)}r.width=707,r.height=606,n.body.appendChild(r),Resources.load(["images/stone-block.png","images/water-block.png","images/grass-block.png","images/enemy-bug.png","images/char-boy.png","images/Rock.png","images/Star.png","images/Heart.png"]),Resources.onReady(function(){t=Date.now(),o()}),e.ctx=i}(void 0);!function(){var n={},a=[];function t(e){if(n[e])return n[e];var t=new Image;t.onload=function(){n[e]=t,r()&&a.forEach(function(e){e()})},n[e]=!1,t.src=e}function r(){var e=!0;for(var t in n)n.hasOwnProperty(t)&&!n[t]&&(e=!1);return e}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)},get:function(e){return n[e]},onReady:function(e){a.push(e)},isReady:r}}();